<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0">
	<!-- BEANs -->
	<!-- Single point of entry to create/modify/update/get resources -->
	<bean id="resourceManager" class="net.i2cat.nexus.resources.ResourceManager" />
	<!-- Single point of entry to get profiles -->
	<bean id="profileManager" class="net.i2cat.nexus.resources.profile.ProfileManager" />
	<!-- Command completers -->
	<bean id="resourceNameCompleter"
		class="net.i2cat.nexus.resources.shell.completers.ResourceNameCompleter" />
	<bean id="profileNameCompleter"
		class="net.i2cat.nexus.resources.shell.completers.ProfileNameCompleter" />


	<!-- Listen for Resource Repositories -->
	<reference-list interface="net.i2cat.nexus.resources.IResourceRepository"
		availability="optional">
		<reference-listener ref="resourceManager"
			bind-method="resourceRepositoryAdded" unbind-method="resourceRepositoryRemoved" />
	</reference-list>

	<!-- Register a ResourceManager as an OSGi Service -->
	<service ref="resourceManager" interface="net.i2cat.nexus.resources.IResourceManager" />

	<!-- Listen for IProfiles -->
	<reference-list interface="net.i2cat.nexus.resources.profile.IProfile"
		availability="optional">
		<reference-listener ref="profileManager"
			bind-method="profileAdded" unbind-method="profileRemoved" />
	</reference-list>

	<!-- Register a ProfileManager as an OSGi Service -->
	<service ref="profileManager"
		interface="net.i2cat.nexus.resources.profile.IProfileManager" />


	<!-- Provide commands to the Karaf shell -->
	<command-bundle xmlns="http://karaf.apache.org/xmlns/shell/v1.0.0">
		<command name="resource/create">
			<action class="net.i2cat.nexus.resources.shell.CreateResourceCommand" />
		</command>
		<command name="resource/list">
			<action class="net.i2cat.nexus.resources.shell.ListResourcesCommand" />
		</command>
		<command name="resource/remove">
			<action class="net.i2cat.nexus.resources.shell.RemoveResourceCommand" />
			<completers>
				<ref component-id="resourceNameCompleter" />
				<null />
			</completers>
		</command>
		<command name="resource/start">
			<action class="net.i2cat.nexus.resources.shell.StartResourceCommand" />
			<completers>
				<ref component-id="resourceNameCompleter" />
				<null />
			</completers>
		</command>
		<command name="resource/stop">
			<action class="net.i2cat.nexus.resources.shell.StopResourceCommand" />
			<completers>
				<ref component-id="resourceNameCompleter" />
				<null />
			</completers>
		</command>
		<command name="resource/export">
			<action
				class="net.i2cat.nexus.resources.shell.ExportResourceDescriptorCommand" />
		</command>
		<command name="resource/info">
			<action class="net.i2cat.nexus.resources.shell.InfoResourcesCommand" />
			<completers>
				<ref component-id="resourceNameCompleter" />
				<null />
			</completers>
		</command>
		<command name="resource/modify">
			<action class="net.i2cat.nexus.resources.shell.ModifyResourceCommand" />
			<completers>
				<ref component-id="resourceNameCompleter" />
				<null />
			</completers>
		</command>
		<command name="resource/refresh">
			<action class="net.i2cat.nexus.resources.shell.RefreshResourceCommand" />
			<completers>
				<ref component-id="resourceNameCompleter" />
				<null />
			</completers>
		</command>
		<!--
			<command name="profile/check"> <action
			class="net.i2cat.nexus.resources.shell.profile.CheckProfileCommand"
			/> </command> <command name="profile/create"> <action
			class="net.i2cat.nexus.resources.shell.profile.CreateProfileCommand"
			/> </command> <command name="profile/edit"> <action
			class="net.i2cat.nexus.resources.shell.profile.EditProfileCommand" />
			</command>
		-->
		<command name="profile/info">
			<action class="net.i2cat.nexus.resources.shell.profile.InfoProfileCommand" />
			<completers>
				<ref component-id="profileNameCompleter" />
				<null />
			</completers>
		</command>
		<command name="profile/list">
			<action class="net.i2cat.nexus.resources.shell.profile.ListProfileCommand" />
		</command>
		<command name="profile/remove">
			<action
				class="net.i2cat.nexus.resources.shell.profile.RemoveProfileCommand" />
			<completers>
				<ref component-id="profileNameCompleter" />
				<null />
			</completers>
		</command>
	</command-bundle>

</blueprint>